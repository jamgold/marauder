<head>
  <title>marauder</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/> <!--640-->
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry&sensor=true"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" media="only screen and (min-device-width: 768px) and (max-device-width: 1024px)" href="ipad.css" />
    <link rel="stylesheet" type="text/css" media="only screen and (max-device-width: 480px)" href="iphone.css" />  
</head>

<body>
	{{>map}}
	{{>buttons}}
	{{>marauder}}
</body>

<template name="buttons">
	<div class="topbuttons top_of_map">
	<div class="btn-group button-toggles" data-toggle="buttons-radio">
	<button class="btn home {{getMode 'home'}}" data-toggle="button" title="goto the current location of your own marker">Home</button>
	<button class="btn browsing {{getMode 'browsing'}}" data-toggle="button" title="Browse around">Browsing</button>
	{{#if currentUser}}
	<button class="btn friends {{getMode 'friends'}}" data-toggle="button" title="Show all your friends online">Show Friends</button>
	<!--button class="btn specify {{getMode 'specify'}}" data-toggle="button" title="Instead of the current location, drag your map pin to the desired location">Specify</button-->
    <label class="checkbox tracking" for="tracking"> <input type="checkbox" class="tracking" id="tracking" {{isChecked "tracking"}}> Track</label>
	{{/if}}
	</div>
	</div>
</template>

<template name="modal">
	<modal class="top_of_map">
		<button type="button" class="close">Close</button>
		{{{activeModeDescription}}}
		{{#if message}}
		<div class=error>{{{message}}}</div>
		{{/if}}
	</modal>
</template>

<template name="marauder">
	{{#if showModal}}
		{{>modal}}
	{{/if}}
	<div id="overlay" class="top_of_map" style="display:{{getDisplayState}}">
		<button type="button" class="close">Close</button>
		{{loginButtons align=left}}
		<h2>Hi there Marauder!</h2>
		{{#if currentUser}}
		{{>friends}}
		{{else}}
		<p>create an account to link up with your friends. You can always pop up this window by clicking on the <a href=# class="marauder-hint">Marauder control up top</a>.</p>
		{{/if}}
		<div class="links">
		{{#if currentUser}}
		<a class="updateFriends">Update Friends</a>
		{{/if}}
		</div>
	</div>
	{{> onlineCounter}}
</template>

<template name="onlineCounter">
	<div class="reactive-hidden">{{onlineCount}}</div>
</template>

<template name="friends">
	<label>Friend Request</label>
	    <input type="text" class="friend-request" placeholder="Enter e-mail address â€¦">
	    <div class=error>{{message}}</div>
	<div class="friends">
	<table class="table table-striped table-hover">
		<thead>
		<tr>
			<th>Friend</th>
			<th>Action</th>
		<tr>
		</thead>
		<tbody>
		{{#each friends}}
			{{> friend}}
		{{/each}}
		{{#each requests}}
			{{> request}}
		{{/each}}
		</tbody>
	</table>
	</div>
</template>

<template name="friend">
	<tr>
		<td><a href="#" class="showuserlocation" title="locate this user on the map" id="{{_id}}">{{getEmail this}}</a></td>
		<td><a href="#" class="removefriendship" title="remove friendship" id="{{_id}}">{{isFriend this}}</a></td>
	</tr>
</template>

<template name="request">
	<tr>		
		<td>{{myOwnRequest this}}</td>
		<td>
			<a href="#" class="removerequest" id="{{_id}}">{{requestRemove this}}</a>
			{{{requestApprove this}}}
		</td>
	</tr>
</template>


<template name="map">
	{{#constant}}
	  <div id="marauder_map"></div>
	{{/constant}}
</template>
